<!doctype html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>TechZone ØªÙŠÙƒ Ø²ÙˆÙ† - Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ</title>
  <meta name="description" content="Ù…Ø³Ø§Ø¹Ø¯ TechZone Ø§Ù„Ø°ÙƒÙŠ - Ø¯Ø¹Ù… ÙÙ†ÙŠ ÙˆØ®Ø¯Ù…Ø© Ø¹Ù…Ù„Ø§Ø¡ Ø¹Ù„Ù‰ Ù…Ø¯Ø§Ø± Ø§Ù„Ø³Ø§Ø¹Ø©">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      /* Palette: Elegant Tech Dark Theme */
      --primary: #4f46e5;
      /* Smart Indigo */
      --primary-glow: #6366f1;
      --accent: #06b6d4;
      /* Cyan for highlights */
      --bg-body: #0b0f19;
      /* Deepest Dark */
      --bg-surface: #111827;
      /* Panel Background */
      --bg-message-bot: #1f2937;
      --bg-message-user: #4f46e5;

      --text-main: #f3f4f6;
      --text-secondary: #9ca3af;

      --shadow-soft: 0 10px 40px -10px rgba(0, 0, 0, 0.5);
      --border-light: 1px solid rgba(255, 255, 255, 0.08);

      --radius-xl: 24px;
      --radius-l: 16px;
      --font-main: 'Tajawal', sans-serif;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: var(--font-main);
      background-color: var(--bg-body);
      color: var(--text-main);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      overflow: hidden;
      background-image:
        radial-gradient(circle at 15% 50%, rgba(79, 70, 229, 0.08), transparent 25%),
        radial-gradient(circle at 85% 30%, rgba(6, 182, 212, 0.08), transparent 25%);
    }

    /* Main Container */
    .chat-layout {
      width: 1000px;
      max-width: 95vw;
      height: 90vh;
      display: flex;
      background: var(--bg-surface);
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow-soft);
      border: var(--border-light);
      overflow: hidden;
      position: relative;
    }

    /* Side Panel / Header for Mobile */
    .sidebar {
      width: 280px;
      background: rgba(17, 24, 39, 0.95);
      border-left: var(--border-light);
      display: flex;
      flex-direction: column;
      padding: 24px;
    }

    /* Chat Area */
    .chat-main {
      flex: 1;
      display: flex;
      flex-direction: column;
      position: relative;
      background: radial-gradient(circle at top, #1f2937 0%, #111827 40%);
    }

    /* Brand Section */
    .brand-section {
      text-align: center;
      margin-bottom: 40px;
    }

    .brand-logo-wrap {
      width: 80px;
      height: 80px;
      margin: 0 auto 16px;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 0 30px rgba(79, 70, 229, 0.3);
      position: relative;
    }

    .brand-logo-wrap svg {
      width: 40px;
      height: 40px;
      fill: #fff;
    }

    .brand-title {
      font-size: 22px;
      font-weight: 800;
      color: #fff;
      margin-bottom: 4px;
      letter-spacing: -0.5px;
    }

    .brand-desc {
      font-size: 13px;
      color: var(--text-secondary);
      line-height: 1.5;
    }

    /* Online Status in Sidebar */
    .status-card {
      background: rgba(255, 255, 255, 0.03);
      border: var(--border-light);
      border-radius: var(--radius-l);
      padding: 12px 16px;
      display: flex;
      align-items: center;
      gap: 12px;
      margin-top: auto;
    }

    .status-indicator {
      width: 8px;
      height: 8px;
      background: #10b981;
      border-radius: 50%;
      box-shadow: 0 0 10px #10b981;
      animation: pulse-green 2s infinite;
    }

    .status-indicator.off {
      background: #ef4444;
      box-shadow: none;
      animation: none;
    }

    @keyframes pulse-green {
      0% {
        box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4);
      }

      70% {
        box-shadow: 0 0 0 6px rgba(16, 185, 129, 0);
      }

      100% {
        box-shadow: 0 0 0 0 rgba(16, 185, 129, 0);
      }
    }

    .status-info h4 {
      font-size: 14px;
      margin: 0;
      color: #fff;
    }

    .status-info p {
      font-size: 11px;
      margin: 2px 0 0;
      color: var(--text-secondary);
    }

    /* Header (Mobile Only mostly) */
    .mobile-header {
      display: none;
      /* Hidden on Desktop */
      padding: 16px;
      background: var(--bg-surface);
      border-bottom: var(--border-light);
      align-items: center;
      gap: 12px;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    /* Messages List */
    .messages-container {
      flex: 1;
      overflow-y: auto;
      padding: 24px;
      display: flex;
      flex-direction: column;
      gap: 18px;
      scroll-behavior: smooth;
    }

    .messages-container::-webkit-scrollbar {
      width: 5px;
    }

    .messages-container::-webkit-scrollbar-thumb {
      background: #374151;
      border-radius: 10px;
    }

    /* Message Item */
    .msg-row {
      display: flex;
      gap: 10px;
      max-width: 80%;
      opacity: 0;
      animation: fadeUp 0.3s forwards;
    }

    @keyframes fadeUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }

      from {
        opacity: 0;
        transform: translateY(10px);
      }
    }

    .msg-row.bot {
      align-self: flex-start;
    }

    .msg-row.user {
      align-self: flex-end;
      flex-direction: row-reverse;
    }

    .msg-avatar {
      width: 32px;
      height: 32px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .msg-row.bot .msg-avatar {
      background: linear-gradient(135deg, var(--bg-surface), #374151);
      border: var(--border-light);
    }

    .msg-row.bot .msg-avatar svg {
      width: 16px;
      fill: var(--accent);
    }

    .msg-row.user .msg-avatar {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
    }

    .msg-row.user .msg-avatar svg {
      width: 16px;
      fill: #fff;
    }

    .msg-bubble {
      padding: 12px 16px;
      border-radius: 18px;
      font-size: 14px;
      line-height: 1.6;
      position: relative;
    }

    .msg-row.bot .msg-bubble {
      background: var(--bg-message-bot);
      color: var(--text-main);
      border-top-right-radius: 18px;
      border-top-left-radius: 4px;
    }

    .msg-row.user .msg-bubble {
      background: var(--bg-message-user);
      color: #fff;
      border-top-left-radius: 18px;
      border-top-right-radius: 4px;
      text-align: left;
    }

    .msg-time {
      font-size: 10px;
      margin-top: 4px;
      opacity: 0.6;
    }

    .msg-row.user .msg-time {
      text-align: left;
    }

    /* Typing Animation */
    .typing {
      display: flex;
      gap: 4px;
      padding: 4px 0;
    }

    .typing span {
      width: 6px;
      height: 6px;
      background: var(--text-secondary);
      border-radius: 50%;
      opacity: 0.5;
      animation: bounce 1.2s infinite;
    }

    .typing span:nth-child(2) {
      animation-delay: 0.2s;
    }

    .typing span:nth-child(3) {
      animation-delay: 0.4s;
    }

    /* Input Area */
    .composer-area {
      padding: 16px;
      background: rgba(17, 24, 39, 0.95);
      /* More solid for mobile contrast */
      backdrop-filter: blur(10px);
      border-top: var(--border-light);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    /* Quick Actions (Chips) */
    .chips-wrap {
      display: flex;
      gap: 8px;
      overflow-x: auto;
      padding-bottom: 8px;
      scrollbar-width: none;
      -webkit-overflow-scrolling: touch;
      /* Smooth scroll on iOS */
    }

    .chips-wrap::-webkit-scrollbar {
      display: none;
    }

    .chip {
      background: rgba(255, 255, 255, 0.05);
      border: var(--border-light);
      padding: 8px 16px;
      /* Larger hit area */
      border-radius: 20px;
      font-size: 13px;
      color: var(--text-secondary);
      cursor: pointer;
      white-space: nowrap;
      transition: all 0.2s;
      flex-shrink: 0;
    }

    .chip:hover,
    .chip:active {
      background: rgba(99, 102, 241, 0.2);
      color: var(--primary-glow);
      border-color: rgba(99, 102, 241, 0.4);
    }

    /* Input Box */
    .input-row {
      display: flex;
      gap: 10px;
      align-items: center;
      background: var(--bg-body);
      border: var(--border-light);
      border-radius: 16px;
      padding: 8px 8px 8px 16px;
      transition: 0.3s;
    }

    .input-row:focus-within {
      border-color: var(--primary);
    }

    .input-field {
      flex: 1;
      background: transparent;
      border: none;
      color: #fff;
      font-family: inherit;
      font-size: 16px;
      /* 16px prevents iOS zoom on focus */
      padding: 10px 0;
      outline: none;
    }

    .input-field::placeholder {
      color: #4b5563;
      font-size: 14px;
    }

    .send-btn {
      width: 44px;
      height: 44px;
      border-radius: 14px;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: 0.2s;
    }

    .send-btn:active {
      transform: scale(0.95);
    }

    .send-btn svg {
      width: 22px;
      fill: #fff;
      transform: rotate(180deg);
    }

    .clear-btn {
      background: none;
      border: none;
      cursor: pointer;
      color: #6b7280;
      padding: 10px;
    }

    .clear-btn:hover {
      color: #ef4444;
    }

    /* RESPONSIVE & MOBILE OPTIMIZATIONS */
    @media (max-width: 768px) {
      body {
        /* Enable scroll on body if needed specifically, but mostly hidden */
        position: fixed;
        /* Prevent body scroll bounce on iOS */
        width: 100%;
        height: 100%;
      }

      .chat-layout {
        width: 100%;
        height: 100dvh;
        /* Dynamic viewport height */
        border-radius: 0;
        border: none;
        flex-direction: column;
        background: var(--bg-body);
      }

      .sidebar {
        display: none;
      }

      .mobile-header {
        display: flex;
      }

      .brand-title {
        font-size: 18px;
      }

      .chat-main {
        border-radius: 0;
      }

      .messages-container {
        padding: 16px;
        gap: 14px;
      }

      .msg-row {
        max-width: 88%;
        gap: 8px;
      }

      .msg-avatar {
        width: 28px;
        height: 28px;
      }

      .msg-bubble {
        padding: 10px 14px;
        font-size: 14px;
      }

      .composer-area {
        padding: 12px 16px 20px;
        /* More bottom padding for home bar */
      }

      .input-row {
        padding: 6px 6px 6px 14px;
      }
    }
  </style>
</head>

<body>

  <div class="chat-layout">

    <!-- Sidebar (Desktop) -->
    <div class="sidebar">
      <div class="brand-section">
        <div class="brand-logo-wrap">
          <svg viewBox="0 0 24 24">
            <path
              d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z" />
          </svg>
        </div>
        <h1 class="brand-title">TechZone</h1>
        <p class="brand-desc">Ø±ÙÙŠÙ‚Ùƒ Ø§Ù„Ø°ÙƒÙŠ ÙÙŠ Ø¹Ø§Ù„Ù… Ø§Ù„ØªÙ‚Ù†ÙŠØ©</p>
      </div>

      <div class="status-card">
        <div class="status-indicator" id="statusDot"></div>
        <div class="status-info">
          <h4 id="statusText">Ù…ØªØµÙ„ Ø§Ù„Ø¢Ù†</h4>
          <p>Ù…Ø³Ø§Ø¹Ø¯ Ø°ÙƒÙŠ 24/7</p>
        </div>
      </div>
    </div>

    <!-- Mobile Header -->
    <div class="mobile-header">
      <div
        style="width:36px;height:36px;background:var(--primary);border-radius:10px;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:bold;flex-shrink:0;">
        <svg viewBox="0 0 24 24" style="width:20px;fill:#fff">
          <path
            d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z" />
        </svg>
      </div>
      <div>
        <h3 style="font-size:16px;margin:0;font-weight:bold;color:var(--text-main);">TechZone</h3>
        <div style="font-size:12px;color:#10b981;display:flex;align-items:center;gap:4px;">
          <span style="width:6px;height:6px;background:#10b981;border-radius:50%;display:inline-block;"></span> Ù…ØªØµÙ„
          Ø§Ù„Ø¢Ù†
        </div>
      </div>
    </div>

    <!-- Main Chat -->
    <div class="chat-main">
      <div class="messages-container" id="messagesContainer">
        <!-- Dynamic Messages -->
        <div style="text-align:center; opacity:0.3; margin:20px 0; font-size:12px;">
          Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© â€¢ <span id="dateSpan"></span>
        </div>
      </div>

      <div class="composer-area">
        <!-- Quick Actions -->
        <div class="chips-wrap">
          <button class="chip" data-msg="Ù…Ø§ Ù‡ÙŠ Ø·Ø±Ù‚ Ø§Ù„Ø´Ø­Ù†ØŸ">ğŸšš Ø§Ù„Ø´Ø­Ù†</button>
          <button class="chip" data-msg="ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø§Ù„Ø¯ÙØ¹ØŸ">ğŸ’³ Ø§Ù„Ø¯ÙØ¹</button>
          <button class="chip" data-msg="Ù…Ø§ Ù‡ÙŠ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ØŸ">â†©ï¸ Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹</button>
          <button class="chip" data-msg="ÙƒÙŠÙ Ø£ØªØªØ¨Ø¹ Ø·Ù„Ø¨ÙŠØŸ">ğŸ“¦ Ø§Ù„ØªØªØ¨Ø¹</button>
          <button class="chip" data-msg="Ù‡Ù„ ÙŠÙˆØ¬Ø¯ Ø¹Ø±ÙˆØ¶ Ø­Ø§Ù„ÙŠØ©ØŸ">ğŸ Ø§Ù„Ø¹Ø±ÙˆØ¶</button>
          <button class="chip" data-msg="ÙƒÙŠÙ Ø§Ù„Ø¶Ù…Ø§Ù†ØŸ">ğŸ›¡ï¸ Ø§Ù„Ø¶Ù…Ø§Ù†</button>
          <button class="chip" data-msg="Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ·Ø¨ÙŠÙ‚">ğŸ“± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</button>
          <button class="chip" data-msg="Ø±Ù‚Ù… Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡">ğŸ“ Ø§Ù„Ø¯Ø¹Ù…</button>
        </div>

        <!-- Input -->
        <div class="input-row">
          <button class="clear-btn" id="clearBtn" title="Ù…Ø³Ø­">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" />
            </svg>
          </button>
          <input type="text" class="input-field" id="messageInput" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³ØªÙØ³Ø§Ø±Ùƒ Ù‡Ù†Ø§..."
            autocomplete="off">
          <button class="send-btn" id="sendBtn">
            <svg viewBox="0 0 24 24">
              <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" />
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const API_URL = "https://noura-chat-api.onrender.com/chat";

    // Elements
    const container = document.getElementById("messagesContainer");
    const input = document.getElementById("messageInput");
    const sendBtn = document.getElementById("sendBtn");
    const clearBtn = document.getElementById("clearBtn");
    const statusDot = document.getElementById("statusDot");
    const statusText = document.getElementById("statusText");

    // Init Date
    document.getElementById("dateSpan").innerText = new Date().toLocaleDateString('ar-SA');

    // Icons
    const USER_ICON = `<svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>`;
    const BOT_ICON = `<svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>`;

    function escapeHtml(text) {
      return String(text).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
    }

    function formatTime() {
      return new Date().toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
    }

    function appendMessage(text, sender, isTyping = false) {
      const div = document.createElement("div");
      div.className = `msg-row ${sender}`;

      let contentHtml = "";
      if (isTyping) {
        contentHtml = `<div class="typing"><span></span><span></span><span></span></div>`;
      } else {
        contentHtml = escapeHtml(text).replace(/\n/g, "<br>");
      }

      div.innerHTML = `
      <div class="msg-avatar">${sender === 'user' ? USER_ICON : BOT_ICON}</div>
      <div>
        <div class="msg-bubble">${contentHtml}</div>
        ${!isTyping ? `<div class="msg-time">${formatTime()}</div>` : ''}
      </div>
    `;

      container.appendChild(div);
      container.scrollTop = container.scrollHeight;
      return div;
    }

    // State
    let typingEl = null;

    function showTyping() {
      if (typingEl) return;
      typingEl = appendMessage("", "bot", true);
    }

    function hideTyping() {
      if (!typingEl) return;
      typingEl.remove();
      typingEl = null;
    }

    // Network
    async function sendMessage() {
      const txt = input.value.trim();
      if (!txt) return;

      input.value = "";
      appendMessage(txt, "user");
      sendBtn.disabled = true;
      showTyping();

      try {
        const res = await fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: txt })
        });

        const data = await res.json();
        hideTyping();

        const answer = data.answer || "Ø¹Ø°Ø±Ù‹Ø§ØŒ Ù„Ù… Ø£ÙÙ‡Ù… Ø°Ù„Ùƒ.";
        appendMessage(answer, "bot");

      } catch (e) {
        hideTyping();
        appendMessage("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ØŒ Ø­Ø§ÙˆÙ„ Ù„Ø§Ø­Ù‚Ù‹Ø§.", "bot");
      } finally {
        sendBtn.disabled = false;
        input.focus();
      }
    }

    // Event Listeners
    sendBtn.onclick = sendMessage;
    input.onkeydown = (e) => { if (e.key === "Enter") sendMessage(); };

    clearBtn.onclick = () => {
      container.innerHTML = `<div style="text-align:center; opacity:0.3; margin:20px 0; font-size:12px;">Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø© â€¢ ${new Date().toLocaleDateString('ar-SA')}</div>`;
      appendMessage("Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰! ğŸ˜Š", "bot");
    };

    document.querySelectorAll(".chip").forEach(btn => {
      btn.onclick = () => {
        input.value = btn.dataset.msg;
        sendMessage();
      }
    });

    // Initial Welcome
    setTimeout(() => {
      appendMessage("Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…ØªØ¬Ø±  TechZone! \nÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ  Ø§Ù„ÙŠÙˆÙ…  ", "bot");
    }, 500);

  </script>
</body>

</html>
